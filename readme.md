# 磁轴键盘延时测试器

## 概述

磁轴键盘延时测试器是一个专为磁轴键盘设计的自动化测试工具，用于精确测量按键的**按下延迟**和**抬起延迟**。它通过**通电线圈模拟磁铁**，用曲线拟合人手按压和释放过程，避免市面上使用机械按压结构加摄像机分帧的测量方式造成的静态误差和随机干扰，整个过程精准可控且最大限度贴近人手使用模式。除了可测量单键的全链路延迟之外，也支持多键和SOCD的延时测试。测试器通过多次快速触发测量平均延迟，提供高精度、可重复的测试结果。本项目适用于键盘制造商、硬件测试人员及键盘爱好者。

## 功能特性

- **极限工况测试**：支持极限快速、极限低速、真实按压等多种不同测试工况的模拟测试
- **自动化测试**：通过通电线圈模拟磁铁触发磁轴开关，消除手动按压的不一致性
- **高精度测量**：支持微秒级延迟检测（精度可达±0.1ms）
- **可重复测试**：支持多次快速触发，计算平均延迟
- **兼容性**：支持常见磁轴键盘（如霍尔效应、磁感应开关）
- **数据显示**：测试结果将直接展示在测试器屏幕

## 系统架构

### 硬件组件

1. **主控制器**：沁恒CH32V305RBT6（支持USB HID通信）
2. **线圈驱动电路**：LDO电路（如D2652-AD）控制通电线圈模拟磁铁动作
3. **线圈驱动接口**：直接连接线圈轴体
4. **电源接口**：直接连接5V/2A直流电源（为线圈和控制器供电）
4. **PC接口**：直接连接电脑（可进行测试器固件升级更新）
4. **USB主机接口**：直接连接待测试磁轴键盘（对键盘进行延时测试）

### 软件组件

1. **固件**（C/C++）：识别接入到测试器的磁轴键盘，控制线圈触发时序对键盘进行延时测试
2. **测试逻辑**：
   - 识别接入的待测试键盘
   - 发送触发信号并记录时间戳
   - 计算按下延迟（从线圈磁场模拟按下到键盘发送按下报文）和抬起延迟（从线圈磁场模拟释放到键盘发送抬起报文）
   - 循环多次测试并统计结果

## 安装与使用

### 硬件连接

1. 将线圈固定在磁轴键盘的待测按键上方（确保与磁轴对齐）
2. 连接线圈到线圈驱动接口
3. 电源供电（5V适配器或USB）
4. 连接磁轴键盘到测试器USB主机接口（USB线）

### 固件升级

1. 安装WCHISPTool_Setup（安装包路径Tools/WCHISPTool_Setup）
2. 打开本项目固件文件 `BinFiles/DelayTestTool_v0.0.2_20250912a`
3. 按下BOOT按键连接到WCH芯片
4. 下载固件

### 文档资料

1. 测试器硬件原理图、PCB以及BOM资料路径/Docs/Hardware/
2. 测试器操作说明资料路径/Docs/UserManual/

### 使用说明
- 测试器使用步骤详情见Docs/UserManual/<延时测试器操作说明.pdf>

## 许可证
- 本项目根据**GNU通用公共许可证v2.0**或者更高版本授权。
- 完整的许可证文本请参阅**LICENSE**文件。

## 注意事项
1. 安全使用：线圈驱动过久会发热严重，请谨慎操作，避免烫伤
2. 校准建议：首次使用时需根据键盘类型进行按键校准和测试模式配置（详情见 Docs/<延时测试器操作说明.pdf>）
3. 兼容性：目前支持常见磁轴键盘（如XSYD、Wooting、MelGeek等）
4. 故障排除：如果测试结果异常，检查线圈轴体是否安装到位或者或者其他错误操作（详情见Docs/<延时测试器操作说明.pdf>）

## 致谢
- 灵感来自磁轴键盘测试需求及开源社区讨论